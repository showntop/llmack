# AI Agent Platform - ä¸»é¡¹ç›®ç®¡ç† Makefile

.PHONY: help install dev build clean test lint check

# é»˜è®¤ç›®æ ‡
help:
	@echo "ğŸ¤– AI Agent Platform - é¡¹ç›®ç®¡ç†"
	@echo "================================="
	@echo ""
	@echo "å¯ç”¨å‘½ä»¤:"
	@echo "  install     - å®‰è£…æ‰€æœ‰ä¾èµ–"
	@echo "  dev         - å¯åŠ¨å¼€å‘ç¯å¢ƒ (å‰åç«¯)"
	@echo "  dev-web     - ä»…å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨"
	@echo "  dev-server  - ä»…å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨"
	@echo "  build       - æ„å»ºæ‰€æœ‰é¡¹ç›®"
	@echo "  test        - è¿è¡Œæ‰€æœ‰æµ‹è¯•"
	@echo "  lint        - ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–"
	@echo "  clean       - æ¸…ç†æ‰€æœ‰æ„å»ºæ–‡ä»¶"
	@echo "  check       - æ£€æŸ¥ç¯å¢ƒå’Œä¾èµ–"

# å®‰è£…æ‰€æœ‰ä¾èµ–
install:
	@echo "ğŸ“¦ å®‰è£…é¡¹ç›®ä¾èµ–..."
	@echo "æ­£åœ¨å®‰è£…å‰ç«¯ä¾èµ–..."
	cd web && $(MAKE) install
	@echo "æ­£åœ¨å®‰è£…åç«¯ä¾èµ–..."
	cd server && $(MAKE) install
	@echo "âœ… æ‰€æœ‰ä¾èµ–å®‰è£…å®Œæˆ!"

# å¯åŠ¨å¼€å‘ç¯å¢ƒ (éœ€è¦ concurrently)
dev:
	@echo "ğŸš€ å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ..."
	@if command -v concurrently >/dev/null 2>&1; then \
		concurrently \
			--names "ğŸŒWEB,ğŸ”§SERVER" \
			--prefix-colors "cyan,yellow" \
			"cd web && $(MAKE) dev" \
			"cd server && $(MAKE) run"; \
	else \
		echo "éœ€è¦å®‰è£… concurrently: npm install -g concurrently"; \
		echo "æˆ–è€…åˆ†åˆ«è¿è¡Œ: make dev-web å’Œ make dev-server"; \
	fi

# ä»…å¯åŠ¨å‰ç«¯
dev-web:
	@echo "ğŸŒ å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨..."
	cd web && $(MAKE) dev

# ä»…å¯åŠ¨åç«¯
dev-server:
	@echo "ğŸ”§ å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨..."
	cd server && $(MAKE) run

# æ„å»ºæ‰€æœ‰é¡¹ç›®
build:
	@echo "ğŸ”¨ æ„å»ºæ‰€æœ‰é¡¹ç›®..."
	@echo "æ„å»ºå‰ç«¯..."
	cd web && $(MAKE) build
	@echo "æ„å»ºåç«¯..."
	cd server && $(MAKE) build
	@echo "âœ… æ„å»ºå®Œæˆ!"

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
test:
	@echo "ğŸ§ª è¿è¡Œæ‰€æœ‰æµ‹è¯•..."
	@echo "è¿è¡Œå‰ç«¯æµ‹è¯•..."
	cd web && $(MAKE) test
	@echo "è¿è¡Œåç«¯æµ‹è¯•..."
	cd server && $(MAKE) test
	@echo "âœ… æµ‹è¯•å®Œæˆ!"

# ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–
lint:
	@echo "ğŸ” ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–..."
	@echo "æ£€æŸ¥å‰ç«¯ä»£ç ..."
	cd web && $(MAKE) lint
	@echo "æ£€æŸ¥åç«¯ä»£ç ..."
	cd server && $(MAKE) lint
	@echo "âœ… ä»£ç æ£€æŸ¥å®Œæˆ!"

# æ¸…ç†æ‰€æœ‰æ„å»ºæ–‡ä»¶
clean:
	@echo "ğŸ§¹ æ¸…ç†æ‰€æœ‰æ„å»ºæ–‡ä»¶..."
	cd web && $(MAKE) clean
	cd server && $(MAKE) clean
	@echo "âœ… æ¸…ç†å®Œæˆ!"

# æ£€æŸ¥ç¯å¢ƒå’Œä¾èµ–
check:
	@echo "ğŸ” æ£€æŸ¥å¼€å‘ç¯å¢ƒ..."
	@echo "æ£€æŸ¥ Node.js..."
	@command -v node >/dev/null 2>&1 || { echo "âŒ éœ€è¦å®‰è£… Node.js"; exit 1; }
	@echo "âœ… Node.js: $(shell node --version)"
	@echo "æ£€æŸ¥ npm..."
	@command -v npm >/dev/null 2>&1 || { echo "âŒ éœ€è¦å®‰è£… npm"; exit 1; }
	@echo "âœ… npm: $(shell npm --version)"
	@echo "æ£€æŸ¥ Go..."
	@command -v go >/dev/null 2>&1 || { echo "âŒ éœ€è¦å®‰è£… Go"; exit 1; }
	@echo "âœ… Go: $(shell go version | cut -d' ' -f3)"
	@echo "æ£€æŸ¥ make..."
	@command -v make >/dev/null 2>&1 || { echo "âŒ éœ€è¦å®‰è£… make"; exit 1; }
	@echo "âœ… make: $(shell make --version | head -1)"
	@echo ""
	@echo "ğŸ‰ å¼€å‘ç¯å¢ƒæ£€æŸ¥å®Œæˆ! æ‰€æœ‰ä¾èµ–éƒ½å·²å®‰è£…"

# é¡¹ç›®ä¿¡æ¯
info:
	@echo "ğŸ“Š AI Agent Platform é¡¹ç›®ä¿¡æ¯"
	@echo "================================="
	@echo "å‰ç«¯æŠ€æœ¯æ ˆ:"
	@echo "  - React 17 + TypeScript"
	@echo "  - Vite (æ„å»ºå·¥å…·)"
	@echo "  - Tailwind CSS (æ ·å¼æ¡†æ¶)"
	@echo ""
	@echo "åç«¯æŠ€æœ¯æ ˆ:"
	@echo "  - Go (æœåŠ¡å™¨è¯­è¨€)"
	@echo "  - net/http (HTTPæœåŠ¡å™¨)"
	@echo "  - Server-Sent Events (å®æ—¶é€šä¿¡)"
	@echo ""
	@echo "ç«¯å£é…ç½®:"
	@echo "  - å‰ç«¯: http://localhost:3000"
	@echo "  - åç«¯: http://localhost:8080"
	@echo ""
	@echo "å¼€å‘æµç¨‹:"
	@echo "  1. make install  # å®‰è£…ä¾èµ–"
	@echo "  2. make dev      # å¯åŠ¨å¼€å‘ç¯å¢ƒ"
	@echo "  3. æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000"

# å®‰è£…å…¨å±€ä¾èµ–
setup:
	@echo "ğŸ› ï¸ å®‰è£…å…¨å±€å¼€å‘ä¾èµ–..."
	npm install -g concurrently
	@echo "âœ… å…¨å±€ä¾èµ–å®‰è£…å®Œæˆ!" 